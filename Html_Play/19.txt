<style>
  /* ... giữ nguyên phần CSS cũ ... */

  .menu-content {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
    margin-top: 10px;
  }

  .inline-group {
    display: flex;
    align-items: center;
    gap: 10px;
    flex-wrap: wrap;
  }

  .inline-group label {
    margin-bottom: 0;
    white-space: nowrap;
  }

  .menu-buttons {
    grid-column: 1 / -1;
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    margin-top: 5px;
  }

  #hiddenMenu {
    /* Thu chiều cao lại bằng padding */
    padding: 15px 20px 10px 20px;
  }
</style>

<div class="menu-content">
  <div id="chon789">
    <label>Chế độ:</label>
    <select class="input-full" id="chon123" onchange="changeKara123()" title="Có thể nhấn phím k/K để chuyển đổi chế độ">
      <option>Bạn hát</option>
      <option>Ca sĩ hát</option>
    </select>
  </div>

  <div>
    <label>Màu chữ ban đầu:</label>
    <input type="color" class="input-full" id="mauX123" onchange="doimauX123()">
  </div>

  <div>
    <label>Font chữ:</label>
    <select class="input-full" title="Chọn kiểu chữ cho text hiển thị karaoke" id="fontKieu123" onchange="doiFontKieu123()">
      <option style="font-family:Arial Black">Arial Black</option>
      <option style="font-family:Segoe Marker">Segoe Marker</option>
      <option style="font-family:Segoe Script">Segoe Script</option>
      <option style="font-family:Tahoma">Tahoma</option>
      <option style="font-family:Times New Roman">Times New Roman</option>
      <option style="font-family:Segoe UI Black">Segoe UI Black</option>
    </select>
  </div>

  <div id="mau789">
    <label>Màu chữ tô điểm:</label>
    <input type="color" class="input-full" id="mau123" onchange="doimau123()">
  </div>

  <div>
    <label>Màu chữ đếm ngược:</label>
    <input type="color" class="input-full" id="mauY123" onchange="doimauY123()">
  </div>

  <div class="inline-group">
    <label>Cỡ chữ:</label>
    <input type="text" class="input-medium" id="kichthuoc123" onchange="doikichthuoc123()">
    <label>Icon đếm:</label>
    <input onchange="kieudem123()" type="text" class="input-short" id="kieudemnguoc123">
  </div>

  <div class="inline-group">
    <label>Độ phủ:</label>
    <input type="text" class="input-medium" id="anhmo123" onchange="moanh123()" title="Từ 0 đến 1">
    <label>Nền:</label>
    <input type="color" class="input-full" id="maunex123" onchange="moanh123()">
  </div>

  <div class="menu-buttons">
    <button title="Nhấn o/O để khởi động lại" onclick="resetKaraoke()">Phát / Khởi động lại</button>
    <button onclick="ghinho123()">Lưu các cài đặt hiện tại</button>
    <button onclick="xoaghinho123()">Xoá các cài đặt - trở về mặc định</button>
    <button onclick="StopKaraoke()">Thoát</button>
    <b id="xemthumau" style="display:none"></b>
    <b id="xemmauthu" style="display:none"></b>
    <b id="xemmaudi" style="display:none"></b>
    <input style="display: none; width: 5em;" id="hang" type="number" min="0" value="0" onchange="doihang()">
    <span id="demnguockieu" style="display:none"></span>
    <input id="temp_text" style="display:none">
    <span id="menuX" style="display:none"></span>
    <span id="thietkeKara" style="display:none"></span>
    <span id="menuan" style="display:none"></span>
  </div>

  <div style="grid-column: 1 / -1">
    <b style="color:yellow">Nhấn phím [SPACE] để trải nghiệm toàn màn hình.</b>
  </div>
</div>

<script>
  var kex = 0;

  function copyshare123() {
    document.getElementById('hiddenMenu').classList.remove('open');
    document.getElementById('menuTrigger').classList.remove('hidden');
    copyshare();
  }

  function ghinho123() {
    document.getElementById('hiddenMenu').classList.remove('open');
    document.getElementById('menuTrigger').classList.remove('hidden');
    ghinho();
  }

  function xoaghinho123() {
    document.getElementById('hiddenMenu').classList.remove('open');
    document.getElementById('menuTrigger').classList.remove('hidden');
    xoaghinho();
  }

  function dongmomenu() {
    document.getElementById("menu").style.display = "none";
  }

  function saveshare123() {
    document.getElementById("saveshare").checked = document.getElementById("save123").checked;
  }

  function changeKara123() {
    document.getElementById("chon").options.selectedIndex = document.getElementById("chon123").options.selectedIndex;
    changeKara();
  }

  function doimau123() {
    document.getElementById("mau").value = document.getElementById("mau123").value;
    doimau();
  }

  function doimauX123() {
    document.getElementById("mauX").value = document.getElementById("mauX123").value;
    doimauX();
  }

  function doimauY123() {
    document.getElementById("mauY").value = document.getElementById("mauY123").value;
    doimauY();
  }

  function doikichthuoc123() {
    document.getElementById("kichthuoc").value = document.getElementById("kichthuoc123").value;
    doikichthuoc();
  }

  function kieudem123() {
    document.getElementById("kieudemnguoc").value = document.getElementById("kieudemnguoc123").value;
  }

  function doiFontKieu123() {
    document.getElementById("fontKieu").options.selectedIndex = document.getElementById("fontKieu123").options.selectedIndex;
    doiFontKieu();
  }

  function moanh123() {
    document.getElementById("anhmo").value = document.getElementById("anhmo123").value;
    document.getElementById("maunex").value = document.getElementById("maunex123").value;
    moanh();
  }

  setInterval(function () {
    if (loadxong6 == 0 || kex == 1) return;
    document.getElementById("modalOverlay8").style.display = "none";

    document.getElementById("maunex123").value = document.getElementById("maunex").value;
    document.getElementById("anhmo123").value = document.getElementById("anhmo").value;
    document.getElementById("fontKieu123").options.selectedIndex = document.getElementById("fontKieu").options.selectedIndex;
    document.getElementById("kieudemnguoc123").value = document.getElementById("kieudemnguoc").value;
    document.getElementById("kichthuoc123").value = document.getElementById("kichthuoc").value;
    document.getElementById("mauY123").value = document.getElementById("mauY").value;
    document.getElementById("mauX123").value = document.getElementById("mauX").value;
    document.getElementById("mau123").value = document.getElementById("mau").value;
    document.getElementById("chon123").options.selectedIndex = document.getElementById("chon").options.selectedIndex;
    document.getElementById("mau789").style.display = (document.getElementById("custom1388") == null) ? "block" : "none";
    document.getElementById("chon789").style.display = document.getElementById("chon").style.display;

    if (document.getElementById("baihatXYZ").innerText != "") {
      document.getElementById("BHphat").innerText = document.getElementById("baihatXYZ").innerText;
    } else {
      document.getElementById("khac1").style.display = "none";
    }

    if (document.getElementById("saveshare") == null) {
      document.getElementById("bgX").style.display = "none";
      document.getElementById("save123").style.display = "none";
      document.getElementById("sae").style.display = "none";
    }

    const trigger = document.getElementById("menuTrigger");
    const menu = document.getElementById("hiddenMenu");
    const kieudemnguoc = document.getElementById("kieudemnguoc");

    let insideMenu = false;
    let inputFocused = false;

    trigger.addEventListener("mouseover", () => {
      menu.classList.add("open");
      trigger.classList.add("hidden");
    });

    menu.addEventListener("mouseover", () => {
      insideMenu = true;
    });

    menu.addEventListener("mouseout", () => {
      insideMenu = false;
      setTimeout(() => {
        if (!insideMenu && !inputFocused) {
          menu.classList.remove("open");
          trigger.classList.remove("hidden");
        }
      }, 300);
    });

    kieudemnguoc.addEventListener("focus", () => {
      inputFocused = true;
    });

    kieudemnguoc.addEventListener("blur", () => {
      inputFocused = false;
      setTimeout(() => {
        if (!insideMenu) {
          menu.classList.remove("open");
          trigger.classList.remove("hidden");
        }
      }, 300);
    });

    kex++;
  }, 1000);
</script>
